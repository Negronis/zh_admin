(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-605dfb3a"],{9205:function(t,e,a){},bcf6:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Button",{ref:"button",staticStyle:{display:"none"},attrs:{id:"btn",type:"primary"},on:{click:t.test}},[t._v("销毁表格")]),t.isLogin?t._e():a("div",{staticClass:"login"},[a("div",{staticClass:"head_top"},[t._v(" 使用前请登录 ")]),a("div",{staticClass:"login_content"},[a("Row",{staticClass:"login_row"},[a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("div",[t._v("用户名：")])]),a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("Input",{staticStyle:{width:"100%"},attrs:{prefix:"ios-contact",placeholder:"请输入用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)],1),a("Row",{staticClass:"login_row"},[a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("div",[t._v("密码：")])]),a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("Input",{staticStyle:{width:"100%"},attrs:{prefix:"ios-lock",type:"password",password:"",placeholder:"请输入密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t.showSelect?a("Row",{staticClass:"login_row"},[a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("div",[t._v("选择医院：")])]),a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("Select",{staticStyle:{width:"100%"},on:{"on-change":t.selectChange},model:{value:t.hospital,callback:function(e){t.hospital=e},expression:"hospital"}},t._l(t.hospital_list,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),a("Row",{staticClass:"login_row"},[a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("div",[t._v("验证码")])]),a("Col",{staticClass:"mar10",attrs:{span:"12"}},[a("Input",{staticStyle:{width:"100%"},attrs:{prefix:"ios-paper",type:"text",placeholder:"请输入验证码"},model:{value:t.check_code,callback:function(e){t.check_code=e},expression:"check_code"}})],1)],1),a("Row",{staticClass:"login_row"},[a("Col",{staticClass:"mar10",attrs:{span:"12"}}),a("Col",{attrs:{span:"12"}},[a("img",{attrs:{alt:"Loading...",src:t.checkCodeSrc,width:"120px",height:"50px"}}),a("a",{staticStyle:{"vertical-align":"middle",display:"inline-block","margin-top":"-20px"},attrs:{href:"javascript:;"},on:{click:t.refresh}},[t._v("看不清？换一张")])])],1),a("Row",[a("Col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[a("Button",{attrs:{disabled:t.isDisabled,type:"primary"},on:{click:t.login}},[t._v("登录")]),a("Button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1)]),t.isLogin?a("div",{staticClass:"table"},[t.showStaffBar?a("Steps",{attrs:{current:t.nowCurrent,status:t.barStatus}},[a("Step",{attrs:{title:"开始上传",content:t.upload_start}}),a("Step",{attrs:{title:"上传中",content:t.uploading}}),a("Step",{attrs:{title:"上传完成",content:"恭喜您，批量上传成功"}})],1):t._e(),a("span",{staticStyle:{color:"red"}},[t._v("注：查询请单独输入一个参数，多个参数可能无法查询")]),a("vxe-grid",{ref:"xGrid",attrs:{border:"",resizable:"","highlight-hover-row":"","import-config":"","export-config":"","show-overflow":"tooltip","show-header-overflow":"tooltip","keep-source":"",height:t.Height-156+"px",align:"center","sort-config":{trigger:"cell"},"filter-config":{remote:!0},"form-config":t.tableForm,"pager-config":t.tablePage,toolbar:t.tableToolbar,"proxy-config":t.tableProxy,columns:t.tableColumn,"checkbox-config":{labelField:"",reserve:!0,highlight:!0,range:!0}},on:{"page-change":t.thePageChange},scopedSlots:t._u([{key:"upload",fn:function(e){var i=e.row;return[a("Button",{staticStyle:{"text-align":"center",width:"50px","margin-right":"5px"},attrs:{size:"small",disabled:"yes"==i["upload"],type:"primary"},on:{click:function(e){return t.upload_btn(i)}}},[t._v("上传")])]}},{key:"tools",fn:function(){return[a("i",{attrs:{title:"普通搜索"}},[a("Icon",{staticStyle:{"margin-top":"3px",cursor:"pointer"},attrs:{type:"ios-search",size:"25"},on:{click:t.showSearch}})],1)]},proxy:!0}],null,!1,2029813799)})],1):t._e()],1)},o=[],r=(a("4160"),a("c975"),a("b64b"),a("d3b7"),a("4ae1"),a("25f0"),a("159b"),a("d4ec")),n=a("bee2"),s=a("262e"),l=a("99de"),c=a("7e84"),u=a("9ab4"),d=a("60a3"),h=!0,p={name:[{required:!0,message:"名称必须填写"},{min:3,max:50,message:"名称长度在 3 到 50 个字符"}],role:[{required:!0,message:"角色必须填写"}]},f={pageSize:15,pageSizes:[5,15,20,50,100,200,500,1e3]},m={data:{patientNo:"",record_time:""},title:"查询",titleWidth:100,titleAlign:"right",items:[{span:8,folding:h,field:"serialNo",title:"serialNo",itemRender:{name:"input",attrs:{placeholder:"请输入住院流水号"}}},{span:8,folding:h,field:"name",title:"姓名",itemRender:{name:"input",attrs:{placeholder:"请输入患者姓名"}}},{span:12,align:"right",itemRender:{name:"input",attrs:{type:"submit",value:"查询"}}},{span:12,align:"left",collapseNode:!0,itemRender:{name:"input",attrs:{type:"reset",value:"重置"}}}]},g=[{type:"checkbox",minWidth:60},{field:"id",title:"ID",minWidth:130,editRender:{name:"input"},sortable:!0,remoteSort:!0},{field:"name",title:"患者姓名",minWidth:130,editRender:{name:"input"},sortable:!0,remoteSort:!0},{field:"serialNo",title:"住院流水号",minWidth:130,editRender:{name:"input"}},{field:"patientNo",title:"住院号",minWidth:130,editRender:{name:"input"}},{field:"effectiveB",title:"住院日期",minWidth:130,editRender:{name:"input"}},{field:"effectiveE",title:"出院日期",minWidth:130,editRender:{name:"input"}},{field:"zhuzhidoctor",title:"主治医生",minWidth:130,editRender:{name:"input"}},{field:"zhuyuandoctor",title:"住院医师",minWidth:130,editRender:{name:"input"}},{field:"oneyear",title:"是否再入院",minWidth:130,editRender:{name:"input"}},{field:"upload",title:"上传状态",minWidth:130,editRender:{name:"input"}},{title:"操作",minWidth:100,slots:{default:"upload"}}],b=(a("a15b"),a("ddb0"),function(t){return{seq:!0,filter:!0,form:!0,sort:!0,props:{result:"data.data.data",total:"data.data.total"},ajax:{query:function(e){var a=e.page,i=e.sort,o=e.filters,r=e.form,n=Object.assign({},r);o.forEach((function(t){t.column;var e=t.property,a=t.values;n[e]=a.join(",")}));i.property,i.order;var s={};for(var l in n)n[l]&&(s[l]=n[l]);var c={};for(var u in n)n[u]&&(c[u]="=");return new Promise((function(e){t(a.currentPage,a.pageSize,s).then((function(t){200===t.status&&e(t)}))}))}}}}),v=b,y=a("0613"),k=a("e368"),S=a("d211");function w(t){var e=_();return function(){var a,i=Object(c["a"])(t);if(e){var o=Object(c["a"])(this).constructor;a=Reflect.construct(i,arguments,o)}else a=i.apply(this,arguments);return Object(l["a"])(this,a)}}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var C=function(t){Object(s["a"])(a,t);var e=w(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.tablePage=f,t.tableToolbar={buttons:[{name:"批量上传",code:"mark_cancel",buttonRender:{name:"ToolbarButtonRefresh",events:{click:t.btnClickEvent}}}],id:"full_edit_1",refresh:!0,import:!0,export:!0,zoom:!0,resizable:{storage:!0},custom:{storage:!0}},t.tableForm={},t.tableProxy={},t.tableColumn=g,t.validRules=p,t.curpage=1,t.pagesizes=15,t.username="焦凤辉",t.password="123456",t.check_code="",t.isDisabled=!1,t.checkCodeSrc="",t.nowCurrent=0,t.barStatus="process",t.upload_start="开始进行平台上传",t.uploading="正在上传中,请耐心等待提示,请勿进行操作",t.staffArray=[],t.showStaffBar=!1,t.showSelect=!1,t.hospital_list=[{value:"handandiyi",label:"邯郸市第一医院"}],t.hospital="",t.random=String(Math.random()),t.key="",t.token="",t}return Object(n["a"])(a,[{key:"showSearch",value:function(){var t=Object.keys(this.tableForm);0===t.length?this.tableForm=m:this.tableForm={}}},{key:"thePageChange",value:function(t){var e=t.currentPage,a=t.pageSize;this.curpage=e,this.pagesizes=a}},{key:"test",value:function(){console.log(123123),this.refleshTable()}},{key:"refleshTable",value:function(){var t=this;k["a"].loading("正在刷新列表",9999),Object(S["n"])(this.curpage,this.pagesizes,localStorage.getItem("hospital_code")).then((function(e){k["a"].destory(),1===e.data.code&&(t.$refs.xGrid.reloadData(e.data.data.data),k["a"].suc("列表刷新成功",1.5))})).catch((function(t){k["a"].error("列表刷新失败,请尝试手动刷新",1.5,(function(){}))}))}},{key:"upload_btn",value:function(t){var e=this,a=[];a.push(t["patient_id"]),k["a"].loading("上传中,请稍后",9999),Object(S["m"])(a).then((function(t){k["a"].destory(),1===t.data.code?k["a"].suc(t.data.msg,2,(function(){e.$nextTick((function(){document.querySelector("#btn").click()}))})):k["a"].error(t.data.msg,2,(function(){"-1"!=t.data.msg.indexOf("登录")?setTimeout((function(){e.init(),sessionStorage.clear(),location.reload()}),2e3):e.$nextTick((function(){document.querySelector("#btn").click()}))}))})).catch((function(t){k["a"].destory(),k["a"].error(t,1.5)}))}},{key:"btnClickEvent",value:function(){k["a"].throttle(this.batch_upload,200)()}},{key:"batch_upload",value:function(){var t=this;if(0===this.staffArray.length)if(0===this.nowCurrent){this.init();var e=[],a=this.$refs.xGrid.getCheckboxRecords();0!==a.length?(a.forEach((function(t){var a=t.id,i=t.upload;"no"===i&&e.push(a)})),0!==e.length?(this.showStaffBar=!0,Object(S["m"])(e).then((function(e){t.changeStatus(e)})).catch((function(t){k["a"].error(t,2)}))):k["a"].error("请选择想要批量上传的患者",2)):k["a"].error("请选择想要批量上传的患者",2)}else k["a"].error("请勿重复上传",2);else k["a"].error("请勿重复上传",2)}},{key:"init",value:function(){this.nowCurrent=0,this.staffArray=[],this.barStatus="process",this.upload_start="开始上传",this.uploading="正在上传中,请耐心等待提示,请勿进行操作",this.showStaffBar=!1}},{key:"changeStatus",value:function(t){var e=this;if(this.barStatus="finish","-1"!=t.data.msg.indexOf("登录"))return this.barStatus="error",this.upload_start=t.data.msg,void k["a"].error(t.data.msg,2,(function(){setTimeout((function(){e.init(),sessionStorage.clear(),location.reload()}),2e3)}));this.nowCurrent=1,this.barStatus="process",1===t.data.code?(setTimeout((function(){e.nowCurrent=2,e.barStatus="finish",k["a"].suc("上传成功,请稍等",2,(function(){document.querySelector("#btn").click()}))}),1e3),setTimeout((function(){e.init()}),3e3)):(this.nowCurrent=1,this.barStatus="error",this.uploading=t.data.msg,setTimeout((function(){e.init()}),3e3))}},{key:"selectChange",value:function(t){localStorage.setItem("hospital_code",t),this.hospital=t}},{key:"login",value:function(){var t=this,e=new this.$formchecked;this.isDisabled=!0,e.add([this.username,this.password,this.check_code],["isEmpty","isEmpty","isEmpty"],["用户名不能为空","密码不能为空","验证码不能为空"]);var a=e.start();a?k["a"].error(a,1,(function(){t.isDisabled=!1})):"admin"!==localStorage.getItem("userInfo")||""!=this.hospital?(k["a"].loading("正在登陆，请稍后",9999),Object(S["o"])(this.username,this.password,this.check_code,this.key).then((function(e){k["a"].destory(),200===e.status&&(1==e.data.code?(y["a"].commit("setIsSession",!0),"心衰中心"===localStorage.getItem("group_name")&&localStorage.setItem("hospital_code",t.hospital),e.data.data&&localStorage.setItem("xszx",e.data.data),t.tableProxy=v(S["n"]),sessionStorage.setItem("up",t.random)):(""==e.data?k["a"].error("该账户不存在",1.5,(function(){t.isDisabled=!1})):k["a"].error(e.data.msg,1.5,(function(){t.isDisabled=!1})),t.recordCheck()))})).catch((function(e){k["a"].destory(),k["a"].error("登陆失败",1.5,(function(){t.isDisabled=!1}))}))):k["a"].error("请选择医院",1,(function(){t.isDisabled=!1}))}},{key:"reset",value:function(){this.username="",this.password="",this.check_code=""}},{key:"refresh",value:function(){this.recordCheck()}},{key:"recordCheck",value:function(){var t=this;Object(S["b"])().then((function(e){console.log(e),t.checkCodeSrc=e.data.data.img,t.key=e.data.data.key})).catch((function(t){k["a"].error("获取验证码失败，可能是中心服务器问题，请等待",1.5)}))}},{key:"created",value:function(){var t=this;"心衰中心"===localStorage.getItem("group_name")?this.showSelect=!0:this.showSelect=!1,y["a"].commit("setIsSession",!1),window.onkeydown=function(e){sessionStorage.getItem("up")||"Enter"===e["key"]&&k["a"].throttle(t.login,500)()},void 0!=localStorage.getItem("xszx")||null!=localStorage.getItem("xszx")||localStorage.getItem("xszx")?(y["a"].commit("setIsSession",!0),this.tableProxy=v(S["n"])):this.recordCheck()}},{key:"isLogin",get:function(){return y["a"].getters.getIsSession}}]),a}(d["c"]);C=u["a"]([d["a"]],C);var x=C,R=x,I=(a("c842"),a("2877")),z=Object(I["a"])(R,i,o,!1,null,null,null);e["default"]=z.exports},c842:function(t,e,a){"use strict";var i=a("9205"),o=a.n(i);o.a}}]);